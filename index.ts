import { parsePacket } from './utils/parse-posted-phonons-packet';
import { isSignatureValid, isSenderCertificateValid } from './utils/validation';

const RAW_PACKET =
	'970800000000000000019210e3545fa40b469f33e7f779aab6a6521c9820c7a372114b6851d21470b853667ed76760d8b8180592944640e2fc309d231c1b9090309002020000804104ab0f963c4417ff1a52303100d1c7f1e15dc50f5af2e89370f477242b1fa1ec0ea7e4442178d1f06585851beca26a39a0f28c09218bb11c217995ae9258d539b63045022054a088e176c1d99b89e4040548e5694dbdae259839eb8d246db8182bd4d2186f022100a359255ff69c69655c640f29ae8f2f62a40d6cd269ebbe6ca934674ea5eabdd893473045022100f02a3934846844a2bc8ca5f874e3358eb9230507a5cdc27e15e9c5473555dd1f0220063aaad75d7a3714f8b6b6bead4eba7c85dee026bfb046d403a8db55c6828349438d448b80410451a22a3b988cc7101d3b2d0e6e07ea77e48fc5eab86f2d36d64fda8422a6979849ed0e62e8d0de461c4010d0adaff3d20c23d63541f4af684ac3f996cd619fb481305a0257417e9b1a33ff008b1b224df25e875573c7e26058cecda67f53ddfa57df1b2367c92fbb44b82139c28d35d4fc7a87010088010089010083010086010082020000200100';

const CA_PUBLIC_KEY =
	'045cfdf77a00b4b6b4a5b8bb26b5497dbc7a4d01cbefd7aaeaf5f6f8f8865976e7941ab0ec1651209c444009fd48d925a17de5040ba47eaf3f5b51720dd40b2f9d';

(async () => {
	const packet = parsePacket(RAW_PACKET);
	console.log(
		'Cert is valid',
		await isSenderCertificateValid(packet, CA_PUBLIC_KEY),
	);
	console.log('Sig is valid', await isSignatureValid(packet));
})();
